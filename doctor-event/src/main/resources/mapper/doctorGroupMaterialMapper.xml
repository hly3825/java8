<?xml version="1.0" encoding="UTF-8" ?>
<!--
  ~ Copyright (c) 2016 杭州端点网络科技有限公司, Code Generated by terminus code gen
  -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="DoctorMasterialDatailsGroup">
    <resultMap id="DoctorMasterialDatailsGroupMap" type="DoctorMasterialDatailsGroup">
        <id column="id" property="id"/>
        <result column="farm_id" property="farmId"/>
        <result column="material_id" property="materialId"/>
        <result column="material_name" property="materialName"/>
        <result column="material_type" property="materialType"/>
        <result column="types" property="type"/>
        <result column="type_name" property="typeName"/>
        <result column="barn_id" property="barnId"/>
        <result column="barn_name" property="barnName"/>
        <result column="numbers" property="number"/>
        <result column="price" property="price"/>
        <result column="price_sum" property="priceSum"/>
        <result column="unit_name" property="unitName"/>
        <result column="group_id" property="groupId"/>
        <result column="group_name" property="groupName"/>
        <result column="ware_house_id" property="wareHouseId"/>
        <result column="ware_house_name" property="wareHouseName"/>
        <result column="event_at" property="eventAt"/>
        <result column="people" property="people"/>
        <result column="flag" property="flag"/>
        <result column="open_at" property="openAt"/>
        <result column="close_at" property="closeAt"/>
        <result column="flush_date" property="flushDate"/>
    </resultMap>

    <sql id="tb">
        doctor_masterial_datails_groups
    </sql>

    <sql id="cols_all">
        id, <include refid="cols_exclude_id" />
    </sql>

    <sql id="cols_exclude_id">
      farm_id,
      material_id,
      material_name,
      material_type,
      types,
      type_name,
      barn_id,
      barn_name,
      numbers,
      price,
      price_sum,
      unit_name,
      group_id,
      group_name,
      ware_house_id,
      ware_house_name,
      event_at,
      people,
      flag,
      open_at,
      close_at,
      flush_date
    </sql>

    <sql id="vals">
      #{farmId},
      #{materialId},
      #{materialName},
      #{materialType},
      #{type},
      #{typeName},
      #{barnId},
      #{barnName},
      #{number},
      #{price},
      #{priceSum},
      #{unitName},
      #{groupId},
      #{groupName},
      #{wareHouseId},
      #{wareHouseName},
      #{eventAt},
      #{people},
      #{flag},
      #{openAt},
      #{closeAt},
      #{flushDate}
    </sql>

    <insert id="create" parameterType="DoctorMasterialDatailsGroup" keyProperty="id" useGeneratedKeys="true">
        INSERT INTO
        <include refid="tb" />
        (<include refid="cols_exclude_id" />)
        VALUES
        (<include refid="vals" />)
    </insert>

    <insert id="creates" parameterType="list">
        INSERT INTO <include refid="tb" />
        (<include refid="cols_exclude_id" />)
        VALUES
        <foreach collection="list" separator="," item="item">
            (
            #{item.farmId},
            #{item.materialId},
            #{item.materialName},
            #{item.materialType},
            #{item.type},
            #{item.typeName},
            #{item.barnId},
            #{item.barnName},
            #{item.number},
            #{item.price},
            #{item.priceSum},
            #{item.unitName},
            #{item.groupId},
            #{item.groupName},
            #{item.wareHouseId},
            #{item.wareHouseName},
            #{item.eventAt},
            #{item.people},
            #{item.flag},
            #{item.openAt},
            #{item.closeAt},
            #{item.flushDate}
            )
        </foreach>
    </insert>

    <!--<update id="update" parameterType="DoctorBarn">-->
        <!--UPDATE-->
        <!--<include refid="tb"/>-->
        <!--<set>-->
            <!--<if test="name != null">name = #{name},</if>-->
            <!--<if test="orgId != null">org_id = #{orgId},</if>-->
            <!--<if test="orgName != null">org_name = #{orgName},</if>-->
            <!--<if test="farmId != null">farm_id = #{farmId},</if>-->
            <!--<if test="farmName != null">farm_name = #{farmName},</if>-->
            <!--<if test="pigType != null">pig_type = #{pigType},</if>-->
            <!--<if test="canOpenGroup != null">can_open_group = #{canOpenGroup},</if>-->
            <!--<if test="status != null">status = #{status},</if>-->
            <!--<if test="capacity != null">capacity = #{capacity},</if>-->
            <!--<if test="staffId != null">staff_id = #{staffId},</if>-->
            <!--<if test="staffName != null">staff_name = #{staffName},</if>-->
            <!--<if test="outId != null">out_id = #{outId},</if>-->
            <!--<if test="extra != null">extra = #{extra},</if>-->
            <!--updated_at=now()-->
        <!--</set>-->
        <!--WHERE id = #{id}-->
    <!--</update>-->

    <delete id="delete" parameterType="int">
        DELETE FROM <include refid="tb"/>
        WHERE flag = #{flag}
    </delete>

    <select id="find" parameterType="map" resultMap="DoctorMasterialDatailsGroupMap">
        SELECT <include refid="cols_exclude_id"/>
        FROM <include refid="tb"/>
        WHERE
        1 = 1
        AND flag = #{flag}
        <if test="farmId != null">AND farm_id = #{farmId}</if>
        <if test="materialId != null">AND material_id = #{materialId}</if>
        <if test="groupId != null">AND group_id = #{groupId}</if>
        <if test="type != null">AND types = #{type}</if>
        <if test="wareHouseId != null">AND ware_house_id = #{wareHouseId}</if>
        <if test="materialName != null" > AND `material_name` LIKE concat('%',#{materialName},'%')</if>
        <if test="materialType != null">AND material_type = #{materialType}</if>
        <if test="barnId != null">AND barn_id = #{barnId}</if>
        <if test="startDate != null"><![CDATA[ AND date_format(`event_at`, '%Y-%m-%d') >= #{startDate} ]]></if>
        <if test="endDate != null"><![CDATA[ AND date_format(`event_at`, '%Y-%m-%d') <= #{endDate} ]]></if>
        <if test="openStartAt != null"><![CDATA[ AND date_format(`open_at`, '%Y-%m-%d') >= #{openStartAt} ]]></if>
        <if test="openEndAt != null"><![CDATA[ AND date_format(`open_at`, '%Y-%m-%d') <= #{openEndAt} ]]></if>
        <if test="closeStartAt != null"><![CDATA[ AND date_format(`close_at`, '%Y-%m-%d') >= #{closeStartAt} ]]></if>
        <if test="closeEndAt != null"><![CDATA[ AND date_format(`close_at`, '%Y-%m-%d') <= #{closeEndAt} ]]></if>
        limit #{offset}, #{limit}
    </select>

    <select id="count" parameterType="map" resultType="long">
        SELECT ifnull(count(*), 0)
        FROM <include refid="tb"/>
        WHERE
        1 = 1
        AND flag = #{flag}
        <if test="farmId != null">AND farm_id = #{farmId}</if>
        <if test="materialId != null">AND material_id = #{materialId}</if>
        <if test="groupId != null">AND group_id = #{groupId}</if>
        <if test="type != null">AND types = #{type}</if>
        <if test="wareHouseId != null">AND ware_house_id = #{wareHouseId}</if>
        <if test="materialType != null">AND material_type = #{materialType}</if>
        <if test="barnId != null">AND barn_id = #{barnId}</if>
        <if test="materialName != null" > AND `material_name` LIKE concat('%',#{materialName},'%')</if>
        <if test="startDate != null"><![CDATA[ AND date_format(`event_at`, '%Y-%m-%d') >= #{startDate} ]]></if>
        <if test="endDate != null"><![CDATA[ AND date_format(`event_at`, '%Y-%m-%d') <= #{endDate} ]]></if>
        <if test="openStartAt != null"><![CDATA[ AND date_format(`open_at`, '%Y-%m-%d') >= #{openStartAt} ]]></if>
        <if test="openEndAt != null"><![CDATA[ AND date_format(`open_at`, '%Y-%m-%d') <= #{openEndAt} ]]></if>
        <if test="closeStartAt != null"><![CDATA[ AND date_format(`close_at`, '%Y-%m-%d') >= #{closeStartAt} ]]></if>
        <if test="closeEndAt != null"><![CDATA[ AND date_format(`close_at`, '%Y-%m-%d') <= #{closeEndAt} ]]></if>
    </select>
</mapper>